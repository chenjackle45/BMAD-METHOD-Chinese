# Python 遊戲開發者的祕笈與趣味筆記

好了，請注意，程式咒術師與像素推手們！這不是你奶奶的拼布教學（除非你奶奶是 Roguelike 遊戲的硬派開發者，那就致敬了，奶奶！）。這是我經過實戰考驗、偶爾有點瘋狂的 Python 2D 遊戲與文字冒險開發偏好，連 Zork 都會覺得描述不夠。如果你要和我合作，或你是個想讀我心思的 AI（祝你好運，那裡像隨機生成的地城），這就是我的祕典。

## 核心理念：保持簡單（KISS）……但不要太簡單

- **Game Loop：** 遊戲的核心！我偏好經典的 `while running:` 迴圈。可預測、可靠，就像我對咖啡的需求一樣。
  - 先處理輸入，再更新遊戲狀態（`tick` 或 `update` 方法），最後渲染。不要把流程搞混，會變得一團亂。
- **模組化：** 我願意用一個王國換一個好模組！拆分內容。如果一個檔案比 JRPG 角色還能捲動得多，那就太長了。思考小而可重用的單元。這樣除錯就不會像在找「威利在哪裡」但威利只是一個字母打錯。
- **Pythonic 原則：** 我們寫的是 Python，不是假裝成 C。List comprehension？當然要用。Generator？一定要用 `yield`！Decorator？只要合理且不會像忍者一樣把東西藏起來就好。

## 技術與函式庫：開發工具（以及一些個人癖好）

- **主要語言：** Python（這還用說。如果你以為不是，那你人生已經 `SyntaxError` 了。）
  - **版本：** 最新穩定 3.x。我不活在 `past-thon`。
- **遊戲函式庫：Pygame**
  - **我的看法：** 老牌可靠。不是最炫的，但能完成任務，就像一把值得信賴的 +1 劍。
  - **為什麼：** 容易上手，彈性高，社群經驗豐富。還有，`blit` 這個詞很好念。Blit。Blit。Blit。
  - **我喜愛的 Pygame 元件：**
    - `pygame.Surface`：我的畫布、我的世界！請尊重它。
    - `pygame.Rect`：當你一定要知道兩個方塊是否碰撞時不可或缺。碰撞、點擊等都靠它。
    - `pygame.sprite.Sprite` 與 `pygame.sprite.Group`：組織遊戲實體的好幫手。避免變成 `tuple` 湯。
    - `pygame.event.get()`：互動的命脈。所有事件都要捕捉（是事件，不是寶可夢……除非你做的是那種遊戲）。
- **文字渲染（適用於 MUDs / 類 Dwarf Fortress 介面）：**
  - Pygame 的 `font.Font` 與 `render()` 處理基本需求沒問題。若要更複雜的主控台介面，若我特別自虐，會考慮用 `curses` 開新執行緒，或用專門的文字 UI 函式庫，如果 Pygame 的功能太「平」。
  - 固定寬度字型是王道。永遠以可讀性優先於花俏。

## 遊戲結構與模式：讓自己不瘋掉的藍圖

- **狀態機：** 玩家狀態、遊戲狀態（選單、遊玩、結束）、敵人 AI……只要有狀態就該有狀態機。避免 `if/elif/else` 金字塔直衝天際。
- **Entity-Component-System (ECS)：** 大型專案我會考慮 ECS。小遊戲可能太重，但當實體有各種屬性與行為時，ECS 是救星。避免繼承樹像奇幻小說的家譜一樣複雜。
  - 若不用完整 ECS，至少要元件化設計。Mixin 是我的好朋友。
- **資產管理：**
  - 把你的 sprites、音效、字型分門別類放在子目錄（如 `assets/sprites`、`assets/sfx` 等）。這不是火箭科學，只是基本常識。
  - 載入：需要時再載入。載入畫面總比遊戲卡頓好。
- **設定檔：** 遊戲設定、敵人數值、關卡資料用 JSON 或 TOML。不要硬編寫數值，除非你喜歡自虐。如果你真的喜歡，建議找人聊聊。設定檔常常是我成功的「key」。

## 程式風格與慣例（「要嘛照我的方式，不然就走向 Bug 地獄」）

- **命名：**
  - 變數與函式用 `snake_case`。這是 Python，不是駱駝選美。
  - 類別用 `PascalCase`。有格調。
  - 常數用 `UPPER_SNAKE_CASE`。有些東西就是要大聲宣告不可變。
- **註解：** 解釋「為什麼」，不是「做什麼」。如果你的程式太聰明需要寫小說來解釋，那就太聰明了。正如我常說：「清楚的程式碼不怕寫文件」。
- **錯誤處理：** `try-except` 是你的好朋友。不要讓你的遊戲像喝太多啤酒的哥布林突擊隊一樣當機。優雅失敗是一種藝術。
- **紀錄：** 除錯時，`print()` 可以快速檢查，但正式除錯請用 `logging` 模組。當出錯時，它能幫你「看得更清楚」。

## 測試：沒錯，遊戲也要測試（尤其是遊戲！）

- **單元測試：** 核心邏輯、工具函式、任何能獨立測試的東西都要測。數學要測，狀態變化要測。不做這件事不是 `pytest`ful，而是疏忽。
- **遊玩測試：** 最重要的測試。如果不好玩，或貓踩鍵盤就壞掉，那就還沒準備好。我的貓是 QA 部門的首席「purrgrammer」。

## 版本控制：Git Gud or Git Lost

- **Git：** 要用、要愛、要常常 commit。寫有意義的 commit 訊息（不要只寫「stuff」或「lol fixed it」）。
- **分支：** 穩定版用 `main` 或 `master`。持續開發用 `develop`。新功能或可能破壞遊戲的想法用 feature branch。

## 臨別叮嚀（也就是更多雙關語）

- 不要害怕重構。第一個想法很少是你的 `best_fit`。
- 記住，遊戲開發中最重要的演算法就是「讓它好玩」。
- 如果卡住了，就休息一下，去散步。有時最好的解法是在你沒「凝視螢幕沉思」時出現。

現在，去 `pygame.display.flip()` 你的像素吧！
