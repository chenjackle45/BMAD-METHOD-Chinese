# 修正航向任務

## 目的

- 使用 `change-checklist` 指導對變更觸發事件的結構化回應。
- 在 `change-checklist` 結構的指導下，分析變更對 epics、專案產出物 (project artifacts) 和 MVP 的影響。
- 根據 `change-checklist` 的提示，探索潛在的解決方案（例如，調整範疇、回溯元素、重新界定功能範疇）。
- 根據分析結果，為所有受影響的專案產出物（例如，epics、user stories、PRD 章節、架構文件章節）草擬具體且可執行的建議更新。
- 產生一份整合的「Sprint 變更提案 (Sprint Change Proposal)」文件，其中包含影響分析和清晰草擬的建議編輯，供使用者審查和批准。
- 如果變更的性質需要其他核心 agent（如 PM 或 Architect）進行根本性的重新規劃，確保有明確的交接路徑。

## 指示

### 1. 初始設定與模式選擇

- **確認任務與輸入：**
  - 向使用者確認正在啟動「修正航向任務」(Correct Course Task)（變更導航與整合）。
  - 驗證變更觸發事件，並確保您已收到使用者對問題及其感知影響的初步解釋。
  - 確認可存取所有相關的專案產出物（例如，PRD、Epics/Stories、架構文件、UI/UX 規格書），以及至關重要的 `change-checklist`（例如，`change-checklist`）。
- **建立互動模式：**
  - 詢問使用者在此任務中偏好的互動模式：
    - **「增量模式 (Incrementally) (預設且建議)：** 我們是否應逐節檢視 `change-checklist`，討論發現並在進入下一部分之前，針對每個相關部分協作草擬建議的變更？這允許進行詳細的、逐步的完善。」
    - **「YOLO 模式 (Batch Processing)：** 或者，您是否偏好我根據 `change-checklist` 進行更批次化的分析，然後呈現一份整合的發現和建議變更，以進行更廣泛的審查？這對於初步評估可能更快，但可能需要對合併的提案進行更廣泛的審查。」
  - 要求使用者選擇他們偏好的模式。
  - 使用者選擇後，確認所選模式（例如，「好的，我們將以增量模式進行。」）。所選模式將決定此任務後續步驟的執行方式。
- **解釋流程：** 簡要告知使用者：「我們現在將使用 `change-checklist` 來分析變更並草擬建議的更新。我將根據我們選擇的互動模式引導您完成 `change-checklist` 中的項目。」
  <rule>當一次提出多個問題或呈現多個要點供使用者輸入時，請清楚地編號（例如，1.、2a.、2b.），以便使用者更容易提供具體的回應。</rule>

### 2. 執行檢查清單分析 (Execute Checklist Analysis) (根據互動模式，增量或批次進行)

- 系統性地完成 `change-checklist` 的第 1-4 節（通常涵蓋變更背景、Epic/Story 影響分析、產出物衝突解決，以及路徑評估/建議）。
- 對於每個檢查清單項目或邏輯項目群組（取決於互動模式）：
  - 向使用者呈現檢查清單中的相關提示或考量事項。
  - 要求必要的資訊，並積極分析相關的專案產出物（PRD、epics、架構文件、story 歷史記錄等）以評估影響。
  - 與使用者討論您對每個項目的發現。
  - 記錄每個檢查清單項目的狀態（例如，`[x] 已處理`、`[N/A]`、`[!] 需要進一步行動`）以及任何相關的筆記或決定。
  - 根據檢查清單第 4 節的提示，共同商定「建議的前進路徑 (Recommended Path Forward)」。

### 3. 草擬建議變更 (Draft Proposed Changes) (增量或批次進行)

- 根據已完成的檢查清單分析（第 1-4 節）和商定的「建議的前進路徑」(Recommended Path Forward)（不包括需要立即交接給 PM/Architect 進行根本性重新規劃的情境）：
  - 識別需要更新的具體專案產出物（例如，特定的 epics、user stories、PRD 章節、架構文件組件、圖表）。
  - **為每個識別出的產出物直接且明確地草擬建議的變更。** 例如：
    - 修訂 user story 文本、驗收標準或優先順序。
    - 在 epics 中新增、移除、重新排序或拆分 user stories。
    - 提議修改後的架構圖片段（例如，提供更新的 Mermaid 圖表區塊或對現有圖表的清晰文字描述）。
    - 更新 PRD 或架構文件中的技術清單、組態詳細資料或特定章節。
    - 如有必要，草擬新的小型輔助產出物（例如，針對特定決策的簡短附錄）。
  - 如果處於「增量模式 (Incremental Mode)」，則在草擬每個產出物或相關產出物的小群組的建議編輯時，與使用者討論並完善這些編輯。
  - 如果處於「YOLO 模式 (YOLO Mode)」，則編譯所有草擬的編輯，以便在下一步驟中呈現。

### 4. 產生包含編輯的「Sprint 變更提案 (Sprint Change Proposal)」

- 將完整的 `change-checklist` 分析（涵蓋第 1-4 節的發現）和所有商定的建議編輯（來自指示 3）整合到一份名為「Sprint 變更提案 (Sprint Change Proposal)」的單一文件中。此提案應符合 `change-checklist` 第 5 節（提案組件）建議的結構。
- 提案必須清楚呈現：
  - **分析摘要：** 簡要概述原始問題、其分析影響（對 epics、產出物、MVP 範疇的影響），以及所選前進路徑的理由。
  - **具體建議編輯：** 對於每個受影響的產出物，清楚地顯示或描述確切的變更（例如，「將 Story X.Y 從：[舊文本] 變更為：[新文本]」，「為 Story A.B 新增驗收標準：[新 AC]」，「按如下方式更新架構文件第 3.2 節：[新的/修改後的文本或圖表描述]」）。
- 將「Sprint 變更提案 (Sprint Change Proposal)」的完整草稿呈現給使用者進行最終審查和回饋。納入使用者要求的任何最終調整。

### 5. 定案與決定後續步驟

- 取得使用者對「Sprint 變更提案 (Sprint Change Proposal)」的明確批准，包括其中記錄的所有具體編輯。
- 將定案的「Sprint 變更提案 (Sprint Change Proposal)」文件提供給使用者。
- **根據已批准變更的性質：**
  - **如果已批准的編輯足以解決變更，並且可以直接實施或由 PO/SM 組織：** 說明「修正航向任務 (Correct Course Task)」在分析和變更提案方面已完成，使用者現在可以繼續實施或記錄這些變更（例如，更新實際的專案文件、backlog 項目）。如果適用，建議交接給 PO/SM agent 進行 backlog 組織。
  - **如果分析和建議的路徑（根據檢查清單第 4 節，可能還有第 6 節）表明變更需要更根本性的重新規劃（例如，重大的範疇變更、主要的架構重做）：** 清楚說明此結論。建議使用者下一步涉及與主要的 PM 或 Architect agent 接洽，使用「Sprint 變更提案 (Sprint Change Proposal)」作為該更深入重新規劃工作的關鍵輸入和背景資訊。

## 產出交付項目 (Output Deliverables)

- **主要：** 一份「Sprint 變更提案 (Sprint Change Proposal)」文件（markdown 格式）。此文件將包含：
  - `change-checklist` 分析摘要（問題、影響、所選路徑的理由）。
  - 針對所有受影響專案產出物的具體、清晰草擬的建議編輯。
- **隱含：** 一份註解的 `change-checklist`（或其完成記錄），反映過程中進行的討論、發現和決策。
